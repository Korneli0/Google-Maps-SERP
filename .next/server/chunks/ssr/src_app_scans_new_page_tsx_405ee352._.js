module.exports=[13720,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(19721),e=a.i(50944),f=a.i(46271),g=a.i(86723),h=a.i(74290),i=a.i(1703),j=a.i(14800),k=a.i(91128),l=c,m=a.i(65802);function n(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class o extends l.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,k.isHTMLElement)(a)&&a.offsetWidth||0,d=(0,k.isHTMLElement)(a)&&a.offsetHeight||0,e=this.props.sizeRef.current;e.height=b.offsetHeight||0,e.width=b.offsetWidth||0,e.top=b.offsetTop,e.left=b.offsetLeft,e.right=c-e.width-e.left,e.bottom=d-e.height-e.top}return null}componentDidUpdate(){}render(){return this.props.children}}function p({children:a,isPresent:d,anchorX:e,anchorY:f,root:g}){let h=(0,l.useId)(),i=(0,l.useRef)(null),j=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:k}=(0,l.useContext)(m.MotionConfigContext),p=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=n(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():n(a[b],null)}}}}(...a),a)}(i,a.props?.ref??a?.ref);return(0,l.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:l,right:m,bottom:n}=j.current;if(d||!i.current||!a||!b)return;let o="left"===e?`left: ${l}`:`right: ${m}`,p="bottom"===f?`bottom: ${n}`:`top: ${c}`;i.current.dataset.motionPopId=h;let q=document.createElement("style");k&&(q.nonce=k);let r=g??document.head;return r.appendChild(q),q.sheet&&q.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${o}px !important;
            ${p}px !important;
          }
        `),()=>{r.contains(q)&&r.removeChild(q)}},[d]),(0,b.jsx)(o,{isPresent:d,childRef:i,sizeRef:j,children:l.cloneElement(a,{ref:p})})}let q=({children:a,initial:d,isPresent:e,onExitComplete:f,custom:g,presenceAffectsLayout:i,mode:k,anchorX:l,anchorY:m,root:n})=>{let o=(0,h.useConstant)(r),q=(0,c.useId)(),s=!0,t=(0,c.useMemo)(()=>(s=!1,{id:q,initial:d,isPresent:e,custom:g,onExitComplete:a=>{for(let b of(o.set(a,!0),o.values()))if(!b)return;f&&f()},register:a=>(o.set(a,!1),()=>o.delete(a))}),[e,o,f]);return i&&s&&(t={...t}),(0,c.useMemo)(()=>{o.forEach((a,b)=>o.set(b,!1))},[e]),c.useEffect(()=>{e||o.size||!f||f()},[e]),"popLayout"===k&&(a=(0,b.jsx)(p,{isPresent:e,anchorX:l,anchorY:m,root:n,children:a})),(0,b.jsx)(j.PresenceContext.Provider,{value:t,children:a})};function r(){return new Map}var s=a.i(20410);let t=a=>a.key||"";function u(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let v=({children:a,custom:d,initial:e=!0,onExitComplete:f,presenceAffectsLayout:j=!0,mode:k="sync",propagate:l=!1,anchorX:m="left",anchorY:n="top",root:o})=>{let[p,r]=(0,s.usePresence)(l),v=(0,c.useMemo)(()=>u(a),[a]),w=l&&!p?[]:v.map(t),x=(0,c.useRef)(!0),y=(0,c.useRef)(v),z=(0,h.useConstant)(()=>new Map),A=(0,c.useRef)(new Set),[B,C]=(0,c.useState)(v),[D,E]=(0,c.useState)(v);(0,i.useIsomorphicLayoutEffect)(()=>{x.current=!1,y.current=v;for(let a=0;a<D.length;a++){let b=t(D[a]);w.includes(b)?(z.delete(b),A.current.delete(b)):!0!==z.get(b)&&z.set(b,!1)}},[D,w.length,w.join("-")]);let F=[];if(v!==B){let a=[...v];for(let b=0;b<D.length;b++){let c=D[b],d=t(c);w.includes(d)||(a.splice(b,0,c),F.push(c))}return"wait"===k&&F.length&&(a=F),E(u(a)),C(v),null}let{forceRender:G}=(0,c.useContext)(g.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:D.map(a=>{let c=t(a),g=(!l||!!p)&&(v===D||w.includes(c));return(0,b.jsx)(q,{isPresent:g,initial:(!x.current||!!e)&&void 0,custom:d,presenceAffectsLayout:j,mode:k,root:o,onExitComplete:g?void 0:()=>{if(A.current.has(c)||(A.current.add(c),!z.has(c)))return;z.set(c,!0);let a=!0;z.forEach(b=>{b||(a=!1)}),a&&(G?.(),E(y.current),l&&r?.(),f&&f())},anchorX:m,anchorY:n,children:a},c)})})};var w=a.i(24987),x=a.i(87532),y=a.i(70106);let z=(0,y.default)("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);var A=a.i(41675),B=a.i(32860),C=a.i(96221);let D=(0,y.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var E=a.i(50429),F=a.i(41710);let G=(0,y.default)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);var H=a.i(57990),I=a.i(9529);let J=(0,d.default)(async()=>{},{loadableGenerated:{modules:[55212]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"h-full w-full bg-gray-100 animate-pulse flex items-center justify-center",children:"Loading Map..."})}),K=[{id:1,title:"Keywords",icon:x.Search},{id:2,title:"Configuration",icon:z},{id:3,title:"Schedule",icon:A.Calendar}];function L(){let a=(0,e.useRouter)(),[d,g]=(0,c.useState)(1),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("QUICK"),[n,o]=(0,c.useState)({keyword:"",businessName:"",address:"",radius:5,gridSize:3,frequency:"ONCE",centerLat:40.7128,centerLng:-74.006}),p=async()=>{i(!0);try{let b=await fetch("/api/scans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(b.ok){let c=await b.json();a.push(`/scans/${c.id}`)}else{let a=await b.json();throw Error(a.details||a.error||"Failed to create scan")}}catch(a){console.error("Failed to create scan:",a),alert(`Error: ${a instanceof Error?a.message:"Unknown error"}`)}finally{i(!1)}},q=async()=>{if(n.address){k(!0);try{let a=await fetch(`/api/geocode?address=${encodeURIComponent(n.address)}`),b=await a.json();b.lat&&b.lng&&o(a=>({...a,centerLat:b.lat,centerLng:b.lng}))}catch(a){console.error("Geocoding failed:",a)}finally{k(!1)}}};return(0,b.jsxs)("div",{className:"max-w-6xl mx-auto py-10",children:[(0,b.jsxs)("div",{className:"mb-10 text-center",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"New Ranking Report"}),(0,b.jsx)("p",{className:"text-gray-500 mt-2",children:"Set up a new local grid tracker in 3 simple steps"})]}),(0,b.jsx)("div",{className:"mb-12",children:(0,b.jsxs)("div",{className:"flex items-center justify-between max-w-xl mx-auto relative",children:[(0,b.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-full h-0.5 bg-gray-200 -z-10"}),K.map(a=>(0,b.jsxs)("div",{className:"flex flex-col items-center bg-gray-50 pt-2 px-2",children:[(0,b.jsx)("div",{className:`
                  w-10 h-10 rounded-full flex items-center justify-center border-2 transition-colors
                  ${d>=a.id?"bg-blue-600 border-blue-600 text-white":"bg-white border-gray-300 text-gray-400"}
                `,children:d>a.id?(0,b.jsx)(D,{size:18}):(0,b.jsx)(a.icon,{size:18})}),(0,b.jsx)("span",{className:`mt-2 text-xs font-bold uppercase tracking-wide ${d>=a.id?"text-blue-700":"text-gray-500"}`,children:a.title})]},a.id))]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[(0,b.jsx)("div",{className:"lg:col-span-8",children:(0,b.jsxs)(I.Card,{className:"min-h-[500px] flex flex-col justify-between",children:[(0,b.jsxs)(v,{mode:"wait",children:[1===d&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Search Parameters"}),(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Enter the business term and location center."})]}),(0,b.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,b.jsx)("button",{onClick:()=>m("QUICK"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition-all ${"QUICK"===l?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-800"}`,children:"Quick Scan"}),(0,b.jsx)("button",{onClick:()=>m("BUSINESS"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition-all ${"BUSINESS"===l?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-800"}`,children:"My Business"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:["BUSINESS"===l&&(0,b.jsxs)("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"My Business Name"}),(0,b.jsx)(I.Input,{placeholder:"e.g. Starbucks",icon:(0,b.jsx)(H.Store,{size:16}),value:n.businessName,onChange:a=>o({...n,businessName:a.target.value})}),(0,b.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:"We will track where this specific business ranks in the grid."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Term"}),(0,b.jsx)(I.Input,{placeholder:"e.g. Divorce Lawyer",icon:(0,b.jsx)(x.Search,{size:16}),value:n.keyword,onChange:a=>o({...n,keyword:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location Address"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(I.Input,{placeholder:"e.g. Times Square, NY",icon:(0,b.jsx)(w.MapPin,{size:16}),value:n.address,onChange:a=>o({...n,address:a.target.value}),className:"flex-1"}),(0,b.jsx)(I.Button,{variant:"secondary",onClick:q,isLoading:j,className:"px-3",title:"Find on map",children:(0,b.jsx)(G,{size:16})})]}),(0,b.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:"Hint: Type address and click arrow to sync map."})]})]}),(0,b.jsx)("div",{className:"h-[240px] rounded-lg overflow-hidden border border-gray-200 relative",children:(0,b.jsx)(J,{center:[n.centerLat,n.centerLng],zoom:13,selectionMode:!0,onCenterChange:(a,b)=>o(c=>({...c,centerLat:a,centerLng:b})),radius:n.radius})})]})]},"step1"),2===d&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Grid Configuration"}),(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"Define the area size and density of points."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Scan Radius (km): ",(0,b.jsxs)("span",{className:"text-blue-600 font-bold",children:[n.radius,"km"]})]}),(0,b.jsx)("input",{type:"range",min:"1",max:"50",step:"1",className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600",value:n.radius,onChange:a=>o({...n,radius:parseInt(a.target.value)})}),(0,b.jsxs)("div",{className:"flex justify-between text-[10px] text-gray-400 mt-1",children:[(0,b.jsx)("span",{children:"1km"}),(0,b.jsx)("span",{children:"50km"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grid Density"}),(0,b.jsxs)(I.Select,{value:n.gridSize,onChange:a=>o({...n,gridSize:parseInt(a.target.value)}),icon:(0,b.jsx)(z,{size:16}),children:[(0,b.jsx)("option",{value:3,children:"3x3 (9 points)"}),(0,b.jsx)("option",{value:5,children:"5x5 (25 points)"}),(0,b.jsx)("option",{value:7,children:"7x7 (49 points)"}),(0,b.jsx)("option",{value:9,children:"9x9 (81 points)"}),(0,b.jsx)("option",{value:13,children:"13x13 (169 points)"})]})]})]}),(0,b.jsx)("div",{className:"h-[240px] rounded-lg overflow-hidden border border-gray-200",children:(0,b.jsx)(J,{center:[n.centerLat,n.centerLng],zoom:12,selectionMode:!0,radius:n.radius,gridSize:n.gridSize})})]})]},"step2"),3===d&&(0,b.jsxs)(f.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Schedule Settings"}),(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:"How often should this report run?"})]}),(0,b.jsx)("div",{className:"space-y-3 max-w-md mx-auto",children:["ONCE","DAILY","WEEKLY"].map(a=>(0,b.jsxs)("div",{onClick:()=>o({...n,frequency:a}),className:`
                                        flex items-center p-4 rounded-lg border cursor-pointer transition-all
                                        ${n.frequency===a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}
                                    `,children:[(0,b.jsx)("div",{className:`
                                        w-5 h-5 rounded-full border flex items-center justify-center mr-3
                                        ${n.frequency===a?"border-blue-600":"border-gray-400"}
                                    `,children:n.frequency===a&&(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 capitalize",children:a.toLowerCase()}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"ONCE"===a?"Run immediately one time":"DAILY"===a?"Runs every 24 hours":"Runs every 7 days"})]})]},a))})]},"step3")]}),(0,b.jsxs)("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-100",children:[d>1?(0,b.jsx)(I.Button,{variant:"outline",onClick:()=>g(a=>Math.max(a-1,1)),children:"Back"}):(0,b.jsx)("div",{}),d<3?(0,b.jsxs)(I.Button,{onClick:()=>g(a=>Math.min(a+1,3)),disabled:!(1===d?("BUSINESS"!==l||!!n.businessName)&&n.keyword&&n.address:2!==d||n.radius>0&&n.gridSize>=3),children:["Continue ",(0,b.jsx)(B.ArrowRight,{className:"ml-2 w-4 h-4"})]}):(0,b.jsxs)(I.Button,{onClick:p,disabled:h,size:"lg",children:[h?(0,b.jsx)(C.Loader2,{className:"animate-spin mr-2"}):(0,b.jsx)(E.Target,{className:"mr-2"}),"Run Scan"]})]})]})}),(0,b.jsx)("div",{className:"lg:col-span-4",children:(0,b.jsxs)("div",{className:"sticky top-6 space-y-6",children:[(0,b.jsxs)(I.Card,{className:"bg-gray-50 border-dashed",children:[(0,b.jsx)("h3",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider mb-4 border-b border-gray-200 pb-2",children:"Scan Summary"}),(0,b.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Keyword"}),(0,b.jsx)("span",{className:"text-gray-500",children:"Mode"}),(0,b.jsx)(I.Badge,{variant:"QUICK"===l?"blue":"default",children:"QUICK"===l?"Quick Scan":"Tracker"})]}),"BUSINESS"===l&&(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Business"}),(0,b.jsx)("span",{className:"font-bold text-gray-900 truncate max-w-[120px]",children:n.businessName||"-"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Keyword"}),(0,b.jsx)("span",{className:"font-bold text-gray-900",children:n.keyword||"-"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Center"}),(0,b.jsxs)("span",{className:"font-mono text-[10px] text-right text-gray-900",children:[n.centerLat.toFixed(4),",",(0,b.jsx)("br",{}),n.centerLng.toFixed(4)]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Grid"}),(0,b.jsxs)("span",{className:"font-medium text-gray-900",children:[n.gridSize,"x",n.gridSize," (",n.gridSize*n.gridSize," points)"]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Radius"}),(0,b.jsxs)("span",{className:"font-medium text-gray-900",children:[n.radius," km"]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Schedule"}),(0,b.jsx)(I.Badge,{variant:"blue",children:n.frequency})]})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-blue-50 text-blue-800 rounded-lg text-xs leading-relaxed border border-blue-100",children:[(0,b.jsx)(F.Clock,{className:"min-w-4 w-4 mt-0.5"}),(0,b.jsxs)("p",{children:["This scan will launch ",(0,b.jsx)("strong",{children:n.gridSize*n.gridSize})," headless browser instances. Estimated processing time: ",(0,b.jsxs)("strong",{children:["~",Math.ceil(n.gridSize*n.gridSize*.5)," mins"]}),"."]})]})]})})]})]})}a.s(["default",()=>L],13720)}];

//# sourceMappingURL=src_app_scans_new_page_tsx_405ee352._.js.map