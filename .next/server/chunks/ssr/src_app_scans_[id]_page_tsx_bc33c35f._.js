module.exports=[24460,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(19721),e=a.i(38246),f=a.i(24987),g=a.i(41675),h=a.i(50429),i=a.i(70106);let j=(0,i.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),k=(0,i.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),l=(0,i.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),m=(0,i.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),n=(0,i.default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),o=(0,i.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var p=a.i(67329);let q=(0,i.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var r=a.i(57990);let s=(0,i.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),t=(0,i.default)("circle-stop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);var u=a.i(50944),v=a.i(9529);let w=(0,d.default)(async()=>{},{loadableGenerated:{modules:[55212]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"h-full w-full flex items-center justify-center bg-gray-100",children:(0,b.jsx)(m,{className:"w-8 h-8 text-gray-400 animate-spin"})})});function x({params:a}){let d=(0,u.useRouter)(),i=(0,c.use)(a),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)("map"),[D,E]=(0,c.useState)(null);if((0,c.useEffect)(()=>{let a=()=>{fetch(`/api/scans/${i.id}`).then(a=>a.json()).then(a=>y(a.scan)).catch(console.error).finally(()=>A(!1))};a();let b=setInterval(()=>{(x?.status==="RUNNING"||x?.status==="PENDING")&&a()},5e3);return()=>clearInterval(b)},[i.id,x?.status]),z)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(m,{className:"animate-spin text-gray-400"})});if(!x)return(0,b.jsx)("div",{children:"Scan not found"});let F=x.gridSize*x.gridSize,G=x.results.length,H=x.results.filter(a=>a.rank&&a.rank<=3).length,I=x.results.filter(a=>a.rank&&a.rank>3&&a.rank<=10).length,J=x.results.reduce((a,b)=>a+(b.rank||20),0)/(G||1),K=a=>{try{return JSON.parse(a)}catch(a){return[]}},L=async()=>{if(confirm("Are you sure you want to delete this report? This action cannot be undone."))try{(await fetch(`/api/scans/${x.id}`,{method:"DELETE"})).ok&&d.push("/scans")}catch(a){console.error("Delete failed:",a),alert("Failed to delete scan")}},M=async()=>{if(confirm("Stop this scan? Results collected so far will be saved."))try{(await fetch(`/api/scans/${x.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"STOPPED"})})).ok&&y(a=>a?{...a,status:"STOPPED"}:null)}catch(a){console.error("Stop failed:",a),alert("Failed to stop scan")}};return(0,b.jsxs)("div",{className:"max-w-[1600px] mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(e.default,{href:"/scans",className:"w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center hover:bg-gray-50 transition-colors",children:(0,b.jsx)(j,{size:16,className:"text-gray-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[x.keyword,(0,b.jsx)(v.Badge,{variant:"COMPLETED"===x.status?"success":"blue",children:x.status})]}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 flex items-center gap-4 mt-1",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(f.MapPin,{size:12})," ",x.centerLat.toFixed(3),", ",x.centerLng.toFixed(3)]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(g.Calendar,{size:12})," ",new Date(x.createdAt).toDateString()]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[("RUNNING"===x.status||"PENDING"===x.status)&&(0,b.jsxs)(v.Button,{variant:"destructive",size:"sm",onClick:M,children:[(0,b.jsx)(t,{size:14,className:"mr-2"})," Stop Scan"]}),(0,b.jsxs)(v.Button,{variant:"outline",size:"sm",onClick:L,className:"text-red-500 hover:text-red-700 hover:bg-red-50 border-red-200",children:[(0,b.jsx)(s,{size:14,className:"mr-2"})," Delete"]}),(0,b.jsxs)(v.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(l,{size:14,className:"mr-2"})," Export"]}),(0,b.jsxs)(v.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(k,{size:14,className:"mr-2"})," Share"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(v.Card,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-700",children:(0,b.jsx)(n,{size:20})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Avg Rank"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["#",Math.round(J)]})]})]}),(0,b.jsxs)(v.Card,{className:"p-4 flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700",children:(0,b.jsx)(h.Target,{size:20})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Visibility"}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[G>0?Math.round(H/G*100):0,"%"]})]})]}),(0,b.jsxs)(v.Card,{className:"p-4 flex flex-col justify-center",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Top 3"}),(0,b.jsx)("span",{className:"font-bold text-emerald-600",children:H})]}),(0,b.jsx)(v.Progress,{value:H,max:G||1,size:"sm",color:"green"})]}),(0,b.jsxs)(v.Card,{className:"p-4 flex flex-col justify-center",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"4-10"}),(0,b.jsx)("span",{className:"font-bold text-amber-600",children:I})]}),(0,b.jsx)(v.Progress,{value:I,max:G||1,size:"sm",color:"yellow"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-3 space-y-4",children:(0,b.jsxs)(v.Card,{noPadding:!0,className:"overflow-hidden h-[600px] flex flex-col border-none shadow-xl ring-1 ring-gray-200",children:[(0,b.jsxs)("div",{className:"p-3 border-b border-gray-100 bg-white flex justify-between items-center z-10",children:[(0,b.jsxs)("div",{className:"flex gap-1 bg-gray-100 p-1 rounded-lg",children:[(0,b.jsx)("button",{onClick:()=>C("map"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition-all ${"map"===B?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-800"}`,children:"Spatial View"}),(0,b.jsx)("button",{onClick:()=>C("list"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition-all ${"list"===B?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-800"}`,children:"List View"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-[10px] text-gray-400 font-mono tracking-tighter uppercase font-bold",children:["Progress: ",G,"/",F," Points"]}),(0,b.jsxs)(v.Button,{variant:"ghost",size:"sm",className:"h-8 text-xs font-bold text-gray-500 hover:text-blue-600",children:[(0,b.jsx)(o,{size:12,className:"mr-1"})," Filters"]})]})]}),(0,b.jsx)("div",{className:"flex-1 relative bg-gray-50",children:"map"===B?(0,b.jsx)(w,{center:[x.centerLat,x.centerLng],zoom:13,points:x.results.map(a=>({...a,hasData:!0}))||[],gridSize:x.gridSize,onPointClick:a=>E(a)}):(0,b.jsx)("div",{className:"p-8 h-full bg-white overflow-y-auto",children:(0,b.jsxs)("table",{className:"w-full text-left",children:[(0,b.jsx)("thead",{className:"bg-gray-50 text-gray-500 text-[10px] uppercase font-bold tracking-wider italic",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3",children:"Point ID"}),(0,b.jsx)("th",{className:"px-6 py-3",children:"Coordinates"}),(0,b.jsx)("th",{className:"px-6 py-3 text-center",children:"Rank Found"}),(0,b.jsx)("th",{className:"px-6 py-3",children:"Status"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-100",children:x.results.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50 text-sm",children:[(0,b.jsx)("td",{className:"px-6 py-4 font-mono text-xs text-gray-400",children:a.id.slice(-8)}),(0,b.jsxs)("td",{className:"px-6 py-4 text-gray-600",children:[a.lat.toFixed(4),", ",a.lng.toFixed(4)]}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:a.rank?(0,b.jsxs)(v.Badge,{variant:a.rank<=3?"success":a.rank<=10?"warning":"destructive",children:["#",a.rank]}):(0,b.jsx)(v.Badge,{children:"N/A"})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)(v.Badge,{variant:"blue",children:"Captured"})})]},a.id))})]})})})]})}),(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(v.Card,{className:"min-h-[600px] flex flex-col p-0 overflow-hidden shadow-xl ring-1 ring-gray-200",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 bg-blue-600 text-white",children:[(0,b.jsxs)("h3",{className:"font-bold flex items-center gap-2",children:[(0,b.jsx)(r.Store,{size:18}),"Pin Inspection"]}),(0,b.jsx)("p",{className:"text-[10px] text-blue-100 mt-1",children:"Select a point on the map to see GBP profiles."})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:D?(0,b.jsxs)("div",{className:"p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-100",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Point Rank"}),(0,b.jsxs)("p",{className:"text-2xl font-black text-gray-900",children:["#",D.rank??"-"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Location"}),(0,b.jsxs)("p",{className:"text-xs font-medium text-gray-600",children:[D.lat.toFixed(4),", ",D.lng.toFixed(4)]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2 px-1",children:[(0,b.jsx)(p.List,{size:12}),"Ranking Profiles"]}),(0,b.jsx)("div",{className:"space-y-1",children:K(D.topResults).length>0?K(D.topResults).map((a,c)=>(0,b.jsxs)("div",{className:`
                                                    p-2.5 rounded-lg border flex items-center justify-between transition-colors
                                                    ${a.name.toLowerCase().includes(x.keyword.toLowerCase())?"bg-blue-50 border-blue-200":"bg-white border-gray-100 hover:border-gray-200"}
                                                `,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,b.jsx)("span",{className:`
                                                        w-6 h-6 rounded flex items-center justify-center text-[10px] font-black
                                                        ${a.rank<=3?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-600"}
                                                    `,children:a.rank}),(0,b.jsx)("span",{className:"text-xs font-semibold text-gray-800 truncate",children:a.name})]}),(0,b.jsx)(q,{size:12,className:"text-gray-300"})]},c)):(0,b.jsxs)("div",{className:"py-12 text-center text-gray-400",children:[(0,b.jsx)(m,{size:24,className:"mx-auto mb-2 opacity-20"}),(0,b.jsx)("p",{className:"text-xs",children:"Processing data..."})]})})]})]}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center p-8 text-center text-gray-400",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-50 flex items-center justify-center mb-4 ring-1 ring-gray-100",children:(0,b.jsx)(h.Target,{size:32,className:"opacity-20"})}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"No Point Selected"}),(0,b.jsx)("p",{className:"text-xs mt-1",children:"Click any circle on the map to inspect the ranking GBP profiles at that coordinate."})]})})]})})]})]})}a.s(["default",()=>x],24460)}];

//# sourceMappingURL=src_app_scans_%5Bid%5D_page_tsx_bc33c35f._.js.map