{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/danish/codeplayground/GMBserp/src/components/ui/Map.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport {\n    MapContainer,\n    TileLayer,\n    CircleMarker,\n    Popup,\n    useMap,\n    ZoomControl,\n    useMapEvents,\n    Circle\n} from 'react-leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\n// Fix for default marker icon\n// @ts-ignore\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n    iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n    iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\ninterface Point {\n    lat: number;\n    lng: number;\n    rank: number | null;\n    id?: string;\n}\n\ninterface MapProps {\n    center: [number, number];\n    zoom: number;\n    points?: Point[];\n    onCenterChange?: (lat: number, lng: number) => void;\n    selectionMode?: boolean;\n    radius?: number; // In KM\n    gridSize?: number;\n    onPointClick?: (point: Point) => void;\n}\n\nfunction MapUpdater({ center, zoom }: { center: [number, number]; zoom: number }) {\n    const map = useMap();\n    useEffect(() => {\n        map.setView(center, zoom);\n    }, [center, zoom, map]);\n    return null;\n}\n\nfunction SelectionHandler({ onCenterChange }: { onCenterChange?: (lat: number, lng: number) => void }) {\n    useMapEvents({\n        click(e) {\n            onCenterChange?.(e.latlng.lat, e.latlng.lng);\n        },\n    });\n    return null;\n}\n\nconst RankMarker = ({ point, onClick }: { point: Point; onClick?: (point: Point) => void }) => {\n    let color = '#9ca3af'; // gray-400 (not found)\n    let fillColor = '#d1d5db'; // gray-300\n    let radius = 14;\n\n    if (point.rank !== null) {\n        if (point.rank <= 3) {\n            color = '#15803d'; // green-700\n            fillColor = '#22c55e'; // green-500\n            radius = 18;\n        } else if (point.rank <= 10) {\n            color = '#b45309'; // amber-700\n            fillColor = '#f59e0b'; // amber-500\n            radius = 16;\n        } else {\n            color = '#b91c1c'; // red-700\n            fillColor = '#ef4444'; // red-500\n        }\n    }\n\n    return (\n        <CircleMarker\n            center={[point.lat, point.lng]}\n            radius={radius}\n            eventHandlers={{\n                click: () => onClick?.(point),\n            }}\n            pathOptions={{\n                color: color,\n                weight: 2,\n                fillColor: fillColor,\n                fillOpacity: 1,\n            }}\n        >\n            {!onClick && (\n                <Popup className=\"font-sans\">\n                    <div className=\"text-center p-1\">\n                        <div className=\"font-bold text-lg mb-1 text-gray-900\">\n                            #{point.rank ?? '-'}\n                        </div>\n                        <div className=\"text-xs text-gray-500\">\n                            Lat: {point.lat.toFixed(4)}<br />\n                            Lng: {point.lng.toFixed(4)}\n                        </div>\n                    </div>\n                </Popup>\n            )}\n        </CircleMarker>\n    );\n};\n\nexport default function LeafletMap({\n    center,\n    zoom,\n    points = [],\n    onCenterChange,\n    selectionMode = false,\n    radius = 5,\n    gridSize = 3,\n    onPointClick\n}: MapProps) {\n    return (\n        <div className=\"h-full w-full relative z-0 bg-gray-100\">\n            <MapContainer\n                center={center}\n                zoom={zoom}\n                style={{ height: '100%', width: '100%' }}\n                scrollWheelZoom={true}\n                zoomControl={false}\n            >\n                <ZoomControl position=\"bottomright\" />\n\n                <TileLayer\n                    attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\n                    url=\"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\"\n                />\n                <MapUpdater center={center} zoom={zoom} />\n\n                {selectionMode && <SelectionHandler onCenterChange={onCenterChange} />}\n\n                {/* Selection Mode Visuals: Circle and Grid Preview */}\n                {selectionMode && (\n                    <>\n                        <Circle\n                            center={center}\n                            radius={radius * 1000}\n                            pathOptions={{ color: '#2563eb', fillColor: '#2563eb', fillOpacity: 0.1, weight: 1, dashArray: '5, 5' }}\n                        />\n                        <CircleMarker\n                            center={center}\n                            radius={6}\n                            pathOptions={{ color: '#1d4ed8', fillColor: '#1d4ed8', fillOpacity: 1 }}\n                        />\n                    </>\n                )}\n\n                {/* Ranking Points */}\n                {points.map((point, i) => (\n                    <RankMarker key={point.id || i} point={point} onClick={onPointClick} />\n                ))}\n            </MapContainer>\n\n            {/* Floating Legend - Only in results mode */}\n            {!selectionMode && points.length > 0 && (\n                <div className=\"absolute top-4 right-4 bg-white/95 backdrop-blur border border-gray-200 p-3 rounded-lg shadow-lg z-[1000] text-xs font-medium space-y-2\">\n                    <div className=\"font-bold text-gray-900 mb-1 border-b border-gray-100 pb-1\">Rank Legend</div>\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-3 h-3 rounded-full bg-green-500 border border-green-700\"></div>\n                        <span className=\"text-gray-700\">1 - 3</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-3 h-3 rounded-full bg-amber-500 border border-amber-700\"></div>\n                        <span className=\"text-gray-700\">4 - 10</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-3 h-3 rounded-full bg-red-500 border border-red-700\"></div>\n                        <span className=\"text-gray-700\">11+</span>\n                    </div>\n                </div>\n            )}\n\n            {selectionMode && (\n                <div className=\"absolute top-4 left-4 bg-white/95 backdrop-blur border border-gray-200 p-3 rounded-lg shadow-lg z-[1000] text-xs font-medium\">\n                    <p className=\"text-blue-600 font-bold\">Interactive Mode</p>\n                    <p className=\"text-gray-500 mt-1\">Click map to set center location.</p>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}